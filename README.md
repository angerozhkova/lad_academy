# –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–µ–º—ã —Å –ø–æ–º–æ—â—å—é RuModernBERT

![PR Curve](https://github.com/user-attachments/assets/d8e97d89-7b09-4ee7-9f59-66f015c065af)

## üìã –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
- [–û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞](#–æ–ø–∏—Å–∞–Ω–∏–µ-–ø—Ä–æ–µ–∫—Ç–∞)
- [–î–∞–Ω–Ω—ã–µ](#–¥–∞–Ω–Ω—ã–µ)
- [–ú–µ—Ç–æ–¥—ã –∏ –ø–æ–¥—Ö–æ–¥—ã](#–º–µ—Ç–æ–¥—ã-–∏-–ø–æ–¥—Ö–æ–¥—ã)
- [–†–µ–∑—É–ª—å—Ç–∞—Ç—ã](#—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)
- [–£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫](#—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–∑–∞–ø—É—Å–∫)
- [–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞](#—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞)
- [–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏](#–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-–º–æ–¥–µ–ª–∏)
- [–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏](#—Ç–µ—Ö-–¥–µ—Ç–∞–ª–∏)
- [–ö–æ–Ω—Ç–∞–∫—Ç—ã](#–∫–æ–Ω—Ç–∞–∫—Ç—ã)

## üéØ –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ <a name="–æ–ø–∏—Å–∞–Ω–∏–µ-–ø—Ä–æ–µ–∫—Ç–∞"></a>

**–ó–∞–¥–∞—á–∞:** –ë–∏–Ω–∞—Ä–Ω–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –∏ –Ω–µ-–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ —Ç–µ–º—ã

**–¶–µ–ª—å:** –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –º–æ–¥–µ–ª—å –Ω–∞ –æ—Å–Ω–æ–≤–µ RuModernBERT –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è, —Å–æ–¥–µ—Ä–∂–∏—Ç –ª–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—É—é —Ç–µ–º–∞—Ç–∏–∫—É (–ø–æ–∏—Å–∫ –∫—É—Ä—Å–æ–≤, –ø–æ–º–æ—â—å –≤ –æ–±—É—á–µ–Ω–∏–∏, —É—á–µ–±–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –∏ —Ç.–¥.)

**–ë–∏–∑–Ω–µ—Å-–∫–æ–Ω—Ç–µ–∫—Å—Ç:** –ú–æ–¥–µ–ª—å –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è:
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –º–æ–¥–µ—Ä–∞—Ü–∏–∏ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö —á–∞—Ç–æ–≤
- –ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –æ–±—Ä–∞—â–µ–Ω–∏–π –≤ —Å–ª—É–∂–±—É –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º
- –ê–Ω–∞–ª–∏–∑–∞ —Å–ø—Ä–æ—Å–∞ –Ω–∞ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
- –ú–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –æ—Ç–¥–µ–ª—ã

## üìä –î–∞–Ω–Ω—ã–µ <a name="–¥–∞–Ω–Ω—ã–µ"></a>

### –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–∞–Ω–Ω—ã—Ö
- **–û—Å–Ω–æ–≤–Ω–æ–π –¥–∞—Ç–∞—Å–µ—Ç:** 4,214 –ø—Ä–∏–º–µ—Ä–æ–≤ —Å —Ä—É—á–Ω–æ–π —Ä–∞–∑–º–µ—Ç–∫–æ–π
- **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –¥–∞—Ç–∞—Å–µ—Ç:** —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–µ–∫—Å—Ç—ã –ø—Ä–∏ –ø–æ–º–æ—â–∏ GPT
- **–ò—Ç–æ–≥–æ–≤—ã–π —Ä–∞–∑–º–µ—Ä:** 3,418 —Å–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏

### –ë–∞–ª–∞–Ω—Å –∫–ª–∞—Å—Å–æ–≤
- **–ö–ª–∞—Å—Å 1 (–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ):** 1709 –ø—Ä–∏–º–µ—Ä–æ–≤
- **–ö–ª–∞—Å—Å 0 (–Ω–µ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ):** 1709 –ø—Ä–∏–º–µ—Ä–æ–≤
### –ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤

**–û–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (–∫–ª–∞—Å—Å 1):**
- "–ò—â—É –∫—É—Ä—Å –ø–æ Python"
- "–ü–æ–º–æ–≥–∏—Ç–µ —Å Django, –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –º–∏–≥—Ä–∞—Ü–∏—è"
- "–ö–∞–∫ –∏–∑—É—á–∞—Ç—å –º–∞—à–∏–Ω–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ —Å –Ω—É–ª—è?"
- "–ü–æ—Å–æ–≤–µ—Ç—É–π—Ç–µ –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä—É –ø–æ –≤–µ–±-—Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ"

**–ù–µ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã (–∫–ª–∞—Å—Å 0):**
- "–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è"
- "–ö–æ–≥–¥–∞ —Å–ª–µ–¥—É—é—â–µ–µ —Å–æ–±—Ä–∞–Ω–∏–µ?"
- "–û–±—Å—É–∂–¥–µ–Ω–∏–µ —Ä–∞–±–æ—á–∏—Ö –º–æ–º–µ–Ω—Ç–æ–≤"
- "–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å —Å–µ—Ä–≤–µ—Ä–æ–º"

## ‚öôÔ∏è –ú–µ—Ç–æ–¥—ã –∏ –ø–æ–¥—Ö–æ–¥—ã <a name="–º–µ—Ç–æ–¥—ã-–∏-–ø–æ–¥—Ö–æ–¥—ã"></a>

### –ü—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```python
def preprocess_text(text: str) -> str:
    # –£–¥–∞–ª–µ–Ω–∏–µ URL, –∫–æ–¥–∞, HTML-—Ç–µ–≥–æ–≤
    # –û—á–∏—Å—Ç–∫–∞ –æ—Ç —ç–º–æ–¥–∑–∏ –∏ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–∏–º–≤–æ–ª–æ–≤
    # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä—É—Å—Å–∫–æ–≥–æ —Ç–µ–∫—Å—Ç–∞
    # –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è (–Ω–∏–∂–Ω–∏–π —Ä–µ–≥–∏—Å—Ç—Ä, –ø—Ä–æ–±–µ–ª—ã)
    return text
```
**–ö–ª—é—á–µ–≤—ã–µ —ç—Ç–∞–ø—ã –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏:**
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ URL –∏ HTML-—Ä–∞–∑–º–µ—Ç–∫–∏
- ‚úÖ –û—á–∏—Å—Ç–∫–∞ –±–ª–æ–∫–æ–≤ –∫–æ–¥–∞ –∏ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –Ω–∞ —Ä—É—Å—Å–∫–æ–º —è–∑—ã–∫–µ
- ‚úÖ –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞ —Ç–µ–∫—Å—Ç–∞
- ‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –¥—É–±–ª–∏–∫–∞—Ç–æ–≤ –∏ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏
- **–ë–∞–∑–æ–≤–∞—è –º–æ–¥–µ–ª—å:** `deepvk/RuModernBERT-base`
- **–¢–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä:** Native RuModernBERT tokenizer
- **–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä:** Linear layer —Å 1 –≤—ã—Ö–æ–¥–æ–º
- **–§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å:** `BCEWithLogitsLoss`

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
```python
# –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞ Optuna
learning_rate: Float[5e-6, 1e-4] (log)
batch_size: Categorical[4, 8, 16, 32, 64, 128]
num_epochs: Integer[2, 5]
weight_decay: Float[0.001, 0.1]
num_layers_to_unfreeze: Integer[0, 10]
```

### –ú–µ—Ç—Ä–∏–∫–∏ –æ—Ü–µ–Ω–∫–∏
- **Precision, Recall, F1-score**
- **Accuracy**
- **–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥:** –º–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏—è precision –ø—Ä–∏ recall = 1.0

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã <a name="—Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã"></a>
### –û–ø—Ç–∏–º–∞–ª—å–Ω—ã–µ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã
```python
best_params = {
    'learning_rate': 3.678376241390165e-05,
    'batch_size': 32,
    'num_epochs': 4,
    'weight_decay': 0.02904037755747972,
    'num_layers_to_unfreeze': 7
}
```

### –§–∏–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
**–û–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø–æ—Ä–æ–≥ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏:** `0.0303`
|    –ú–µ—Ç—Ä–∏–∫–∞    | –ó–Ω–∞—á–µ–Ω–∏–µ |
|---------------|----------|
| Accuracy  | 0.93     |
| Precision | 0.88     |
| Recall    | 1.00     |
| F1-Score  | 0.94     |

### –ú–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫
| –§–∞–∫—Ç / –ü—Ä–æ–≥–Ω–æ–∑ | –ö–ª–∞—Å—Å 0 | –ö–ª–∞—Å—Å 1 |
|----------------|---------|---------|
| **–ö–ª–∞—Å—Å 0**    | 290     | 45      |
| **–ö–ª–∞—Å—Å 1**    | 0       | 333     |

**–ê–Ω–∞–ª–∏–∑ –æ—à–∏–±–æ–∫:**
- **False Positive:** 45 –ø—Ä–∏–º–µ—Ä–æ–≤ (–Ω–µ-–æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ, –∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω—ã –∫–∞–∫ –æ–±—Ä–∞–∑–æ–≤–∞—Ç–µ–ª—å–Ω—ã–µ)
- **False Negative:** 0 –ø—Ä–∏–º–µ—Ä–æ–≤ (–∏–¥–µ–∞–ª—å–Ω—ã–π recall)

### –ö—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è
**–°—Ä–µ–¥–Ω—è—è precision –ø–æ 7 —Ñ–æ–ª–¥–∞–º:** `0.891`

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫ <a name="—É—Å—Ç–∞–Ω–æ–≤–∫–∞-–∏-–∑–∞–ø—É—Å–∫"></a>
### –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è
```python
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏–∑ requirements.txt
pip install -r requirements.txt
```

### –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
```python
import pandas as pd
from train_rumodernbert import prepare_data, balance_dataset

# –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
data = pd.read_csv("dataset.csv", sep=';')
data_aug = pd.read_csv("gpt_message_label_1.csv", sep=";")

# –û–±—ä–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ –±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∫–∞
df = pd.DataFrame({
    "text": data['text'].tolist() + data_aug['text'].tolist(), 
    "label": data['label'].tolist() + data_aug['label'].tolist()
})
df = balance_dataset(df)
```
### –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
```python
from train_rumodernbert import prepare_data, train_model, best_params

# –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
train_dataset, val_dataset, full_dataset, max_length, val_texts, val_labels = prepare_data(df)

# –û–±—É—á–µ–Ω–∏–µ —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –º–æ–¥–µ–ª–∏
final_model = train_model(train_dataset, val_dataset, best_params)
```

### –û—Ü–µ–Ω–∫–∞ –º–æ–¥–µ–ª–∏
```python
from train_rumodernbert import predict_and_optimize

# –û—Ü–µ–Ω–∫–∞ –Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–æ–π –≤—ã–±–æ—Ä–∫–µ
y_true = np.array(val_labels).astype(float)
val_probs, best_thresh, best_prec = predict_and_optimize(
    final_model, val_dataset, y_true, val_texts
)
```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞ <a name="—Å—Ç—Ä—É–∫—Ç—É—Ä–∞-–ø—Ä–æ–µ–∫—Ç–∞"></a>
```text
lad_academy/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ preprocess.py              # –§—É–Ω–∫—Ü–∏–∏ –ø—Ä–µ–¥–æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ config.py                  # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—É—Ç–µ–π –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
‚îú‚îÄ‚îÄ model/
‚îÇ   ‚îî‚îÄ‚îÄ threshold.txt              # –ü–æ—Ä–æ–≥ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (0.0303)
‚îú‚îÄ‚îÄ training/
‚îÇ   ‚îú‚îÄ‚îÄ train_rumodernbert.ipynb   # Jupyter Notebook –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ hard_negative_dataset.csv  # –ù–µ—Ü–µ–ª–µ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–∫–ª–∞—Å—Å 0)
‚îÇ   ‚îú‚îÄ‚îÄ real_label_1_dataset.csv   # –¶–µ–ª–µ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–∫–ª–∞—Å—Å 1)
‚îÇ   ‚îú‚îÄ‚îÄ syn_label_1_dataset.csv    # –°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è (–∫–ª–∞—Å—Å 1)
‚îÇ   ‚îî‚îÄ‚îÄ test.csv                   # –¢–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ –±–µ–∑ –º–µ—Ç–æ–∫
‚îú‚îÄ‚îÄ requirements.txt               # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞
‚îî‚îÄ‚îÄ README.md                      # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```
## üîÆ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏ <a name="–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ-–º–æ–¥–µ–ª–∏"></a>
### –ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—É—á–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
**–ó–∞–≥—Ä—É–∑–∏—Ç–µ –º–æ–¥–µ–ª—å –∏ —Ç–æ–∫–µ–Ω–∏–∑–∞—Ç–æ—Ä –∏–∑ —Ä–µ–ª–∏–∑–∞:**
- –ü–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ [v1.0](https://github.com/angerozhkova/lad_academy/releases/tag/v.1.0).
- –°–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª—ã –∏ —Ä–∞—Å–ø–∞–∫—É–π—Ç–µ –≤ model/.
  
```python
import torch
import numpy as np
from transformers import AutoTokenizer, AutoModelForSequenceClassification
from src.config import MODEL_PATH, MAX_LENGTH
from src.preprocess import preprocess

# –ú–æ–¥–µ–ª—å –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ —Ä–µ–ª–∏–∑–µ v1.0
tokenizer = AutoTokenizer.from_pretrained(MODEL_PATH)
model = AutoModelForSequenceClassification.from_pretrained(MODEL_PATH)

# –ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Ä–æ–≥–∞
with open(f"{MODEL_PATH}/threshold.txt", "r") as f:
    threshold = float(f.read())
```

### –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –Ω–∞ –Ω–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
```python
processed_texts = [preprocess_text(t) for t in texts]
```
```python
tokens = tokenizer(processed_text,
                   max_length=MAX_LENGTH,
                   padding=True,
                   truncation=True,
                   return_tensors="pt")
print(tokens)  # –û–∂–∏–¥–∞–µ—Ç—Å—è: –æ–±—ä–µ–∫—Ç —Å input_ids, attention_mask –∏ —Ç.–¥.
```
```python
# –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏ –≤ —Ä–µ–∂–∏–º –æ—Ü–µ–Ω–∫–∏
model.eval()

# –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –±–µ–∑ –≥—Ä–∞–¥–∏–µ–Ω—Ç–æ–≤
with torch.no_grad():
    outputs = model(**{k: v.to("cuda") for k, v in tokens.items()})

# –í—ã—á–∏—Å–ª–µ–Ω–∏–µ –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏
probs = torch.sigmoid(outputs.logits.squeeze()).cpu().numpy()

# –ü–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
pred = (probs >= threshold).astype(int)

# –í—ã–≤–æ–¥ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
print(f"–¢–µ–∫—Å—Ç: {text}")
print(f"–ö–ª–∞—Å—Å: {pred} (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å: {probs:.3f})")
```

### –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞:
```python
# –ü—Ä–∏–º–µ—Ä –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞
new_texts = ["–Ø —Ç–µ–±–µ —Å–∫–∏–Ω—É —Ö–æ—Ä–æ—à–∏–π –∫—É—Ä—Å –ø–æ Python", "–£ –º–µ–Ω—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ","–ö–æ–≥–¥–∞ —Å–ª–µ–¥—É—é—â–µ–µ –∑–∞–Ω—è—Ç–∏–µ?"]

preds, probs = inference_on_new(model, tokenizer, text, threshold, MAX_LENGTH)
for text, pred, prob in zip(text, preds, probs):
    print(f"\n{text}\n ‚Üí –ö–ª–∞—Å—Å: {pred} (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å: {prob:.3f})")
```
```text
–Ø —Ç–µ–±–µ —Å–∫–∏–Ω—É —Ö–æ—Ä–æ—à–∏–π –∫—É—Ä—Å –ø–æ Python
 ‚Üí –ö–ª–∞—Å—Å: 1 (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å: 0.237)

–£ –º–µ–Ω—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
 ‚Üí –ö–ª–∞—Å—Å: 0 (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å: 0.000)

–ö–æ–≥–¥–∞ —Å–ª–µ–¥—É—é—â–µ–µ –∑–∞–Ω—è—Ç–∏–µ?
 ‚Üí –ö–ª–∞—Å—Å: 0 (–≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å: 0.000)
```

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏ <a name="—Ç–µ—Ö-–¥–µ—Ç–∞–ª–∏"></a>
### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
- **–ö–∞—Å—Ç–æ–º–Ω—ã–π Trainer** –¥–ª—è –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å BCEWithLogitsLoss
- **–°—Ç—Ä–∞—Ç–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏—è** (7 —Ñ–æ–ª–¥–æ–≤)
- **–ò–∑–æ—Ç–æ–Ω–∏—á–µ—Å–∫–∞—è –∫–∞–ª–∏–±—Ä–æ–≤–∫–∞** –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–µ–π
- **–ü–æ—ç—Ç–∞–ø–Ω–æ–µ —Ä–∞–∑–º–æ—Ä–∞–∂–∏–≤–∞–Ω–∏–µ** —Å–ª–æ–µ–≤ BERT
- **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –ø–æ–¥–±–æ—Ä** –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –ø–æ—Ä–æ–≥–∞ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- **–í—Ä–µ–º—è –æ–±—É—á–µ–Ω–∏—è:** ~8-10 –º–∏–Ω—É—Ç (4 —ç–ø–æ—Ö–∏)
- **–ü–∞–º—è—Ç—å:** ~2.3 GB (GPU)
- **–°–∫–æ—Ä–æ—Å—Ç—å –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞:** ~1000 –ø—Ä–∏–º–µ—Ä–æ–≤/—Å–µ–∫—É–Ω–¥—É

## üë§ –ê–≤—Ç–æ—Ä <a name="–∫–æ–Ω—Ç–∞–∫—Ç—ã"></a>
### –†–æ–∂–∫–æ–≤–∞ –ê–Ω–≥–µ–ª–∏–Ω–∞
- üìß Email: angerozhkova@gmail.com
- üì± Telegram: [@Vincent_Van_Gogh](https://t.me/Vincent_Van_Gogh)
